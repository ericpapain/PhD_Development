/*********************************************
 * OPL 20.1.0.0 Data
 * Author: epmezatio
 * Creation Date: 15 sept. 2021 at 12:34:15
 *********************************************/


  // indices
 
 S = 4; // fournisseurs
 R = 3; // matières premières -- oil,coal and ingredients
 F = 3; // sites de production
 P = 3; // produits finis
 W = 2; // entrepot, zone de dépôts
 T = 3; // moyen de transport
 N = 3; // nombres de clients
 
 U = 4; // nombre de sous traitants
 
 //cp = 229; //carbon prize
 
 
 //CPS = [[15000000 0 0 0],[0 9000000 60000900 0],[0 0 0 20000000]];
 CPS = [[150000000 786660080 88700560 980087350],[988807650 9000000 60009000 8707640],[9332040 7608850 54066540 20000000]]; 
 //CPS = [[0 0 0 0],[0 0 0 0],[0 0 0 0]];
 
 SLC = [10 10 10 10];
 
 EMS = [[0.30 0.2 0.210 0.10],[0.7 0.53 0.19 0.23],[0.30 0.70 0.8 0.30]];
 EMSS = [[0.40 0.3 0.30 0.20],[0.8 0.59 0.23 0.3],[0.40 0.80 0.9 0.40]];

 PRS = [[6750   4562 8456 7845],[4580 6350 6350 2150],[5460 8045 7809 17000]];
 
 //CR = [[2 3 0],[1 3 2],[5 0 4]];
 CR = [[36 32 41],[210 348 431],[233 2131 734]];
 
 
 CPF = [[2900000 3011000 2511000],[2802200 2502200 2011000],[2802200 2022000 2023000]];
 
 //capacité de production chez les sous traitants
 cpfs = [[0 30000 0 0],[28000 25000 0 45042],[0 0 0 57803]];
 
 //CCF = [7650000 7200000 6750000]; // 3% du cout d'établissement globale de l'unité de production/'
  
 ACF = [255000000 24000000 225000000];
 
 //VCF = [510 470 415];
 // nouvelle valeur du couut de production fixe en fonction du site et du produit on vients d'ajouter un nouvelle indice
 VCF = [[110 270 315],[210 370 415],[310 470 515]];
 // cout de production chez le sous traitants vaut moitier de prod 
 vcu = [[55 140 150 103],[120 140 210 180],[120 200 210 110]];
 
 //EMP = [0.15 0.15 0.15];
 //nouvelle valeurs
 EMP = [[0.19 0.15 0.12],[0.115 0.15 0.11],[0.25 0.45 0.5]];
 
 CPW = [[250000000 35000000000],[250000000 3000000000],[20000000000 25000000000]];
 
 //CCW = [1260000 1440000]; // 3% du cout d'établissement globale de l'entrepot/warehouse''
 
 ACW = [42000000 48000000];
 
TCS =  [[[[ 6.03613205  7.40201336  5.92034053],
   [ 2.30520567 13.25755728 14.50616683],
   [ 5.91612706  5.94998395 14.37486798]],
  [[ 7.73515255  7.42002672 14.986906  ],
   [ 8.88870201  5.21501501  4.99649757],
   [ 8.48052461  9.40088297 12.15622967]],
  [[ 0.59666001  1.13057179 11.93083142],
   [ 9.80590713  6.33563703  8.29922812],
   [ 8.1272315   9.11680791  6.1339673 ]],
  [[11.40730438  1.96971022  6.08426388],
   [ 7.86818292 10.73599131  7.58441928],
   [ 3.15813409  6.45135857 14.21328871]]],
 [[[ 2.87348502  4.06225116 14.36728872],
   [ 4.21364134  2.74298417 13.38264854],
   [ 3.96066625  4.88345596  9.28909292]],
  [[14.31209843  9.31625535 11.27522063],
   [ 6.47950932  2.6213189   3.96868891],
   [ 9.41887032  1.23238289  7.87378774]],
  [[ 5.30749513  3.81084172 11.25199902],
   [11.56397396 12.34322427  6.28862408],
   [ 1.704709    6.20582319 13.33178746]],
  [[ 9.35048633 11.92004435  9.88501291],
   [ 8.2440732   2.90991052  5.80528809],
   [11.22483059  2.68725956 13.27283391]]],
 [[[ 3.73523655  8.61497898 10.90027762],
   [ 3.35377335  6.78347595 13.38709322],
   [14.83885947 10.16266084  5.78357676]],
  [[ 2.81788559  7.08658582  2.01818662],
   [ 1.33255406 10.08819002  1.11233275],
   [11.74944594  9.32444176 12.26113646]],
  [[12.98039167 12.31746152  4.45015216],
   [13.70744417  5.73358952  1.0757888 ],
   [ 1.52621537  3.64011228  3.54488364]],
  [[11.55976859  4.61302154 14.92700881],
   [ 8.0691952   3.51631872 14.09217932],
   [ 1.45840323 11.29200345  3.96770424]]]];
 		
 DTS = [[[800 1300 8000],[400 870 9000],[1000 600 15000],[1200 200 800]],
 		[[1200 1700 6000],[600 800 5000],[1200 1000 10000],[1300 400 830]],
 		[[600 300 283],[523 682 931],[667 921 426],[714 890 629]]];
 		
TCF =  [[[[ 3.03794209 48.91908459],
   [ 6.86093541 38.13368327],
   [24.70317856 32.52112406]],
  [[37.31241464 19.86376207],
   [30.36361897 40.27032278],
   [23.68317224 14.53490588]],
  [[23.39818695 43.81406754],
   [ 8.42128994  2.32609824],
   [44.44954203  7.41510762]]],
 [[[31.20847671 23.07649345],
   [14.38057839 17.59986029],
   [22.82359693 13.04934644]],
  [[16.9694097  26.94824877],
   [12.95804073  9.12475009],
   [12.62254891 20.35268766]],
  [[25.65134198 49.79212666],
   [26.86292333 32.02379336],
   [20.83817217 45.01389581]]],
 [[[44.36654749 16.4823724 ],
   [43.7387473  16.55374474],
   [37.29039798 25.38880219]],
  [[15.6342583  34.24499921],
   [35.83767597 17.5706044 ],
   [46.79366191 13.97075138]],
  [[ 8.93700005 36.9100703 ],
   [38.65028515 37.16871251],
   [ 2.51955897 30.66062103]]]];
 	
  DTF = [[[28 33],[48 56],[180 340]],
 		[[15 23],[49 86],[210 230]],
 		[[46 219],[183 203],[128 98]]];
 
 TCW =  [[[[ 47.83484031 137.23220117 109.27034059],
   [ 54.72351899  15.19006755 133.53319248]],
  [[ 80.92105905  17.88179823  47.68835505],
   [ 76.90196558 142.77753301  37.49968855]],
  [[ 97.01988464  68.77956164  29.47162967],
   [ 50.04873463 100.83547682  37.65381651]]],
 [[[136.46042571 133.3112682    6.13588985],
   [ 78.27554038   8.23671944  90.00060958]],
  [[ 78.03979494  58.24547845 131.24670319],
   [108.45694905 119.56654026  85.52647229]],
  [[ 13.83494071 149.65889222 123.72619512],
   [ 33.15675068 146.64277362  45.00856405]]],
 [[[ 30.64509898  19.51306965  46.06220136],
   [  8.45925508  72.00260244 142.15445187]],
  [[ 63.42831362 133.17413843  10.78523245],
   [ 43.74470316  40.82772022 119.96377181]],
  [[ 79.79869442  82.50410096  22.49580331],
   [121.71785081  38.88691957  11.55989135]]]];
 
   DTW = [[[408 7800 689],[298 9000 4000]],
 		[[814 300 504],[495 291 314]],
 		[[1209 670 1498],[698 406 299]]];
 		
  EMT = [0.07 0.025 0.043];
  
  //DM =  [[80000 570900 15088],[24550 10534 10994],[10605 60506 8060]];
  //DM =  [[1000 1000 1000],[2004 1005 1900],[1090 6900 8870]];
  
  // ajout de nouvelle valeurs pour tester la focntion objectifs P1
  
  // cout de sous utilisation de la capacité de production en fonction du produit et par site de prod interne
  
  //csu = [[290 3000 2500],[2800 2500 2000],[2800 2000 2000]];
  //csu = [[0 0 0],[0 0 0],[0 0 0]];
  
  // cout de stockage par produit
  kp = [[150 250],[250 350],[300 450]];
  
  // cout de stockage par produit
  s = [[10 70 15],[20 37 41],[10 70 55]];
  
  //cout de selection de sous traitant
  spl=[2000 3000 4340 5849];
  
  // prix unitaire de matière première disponible chez le sous triatants
  
pms = [[6750   4562 8456 7845],[4580 6350 6350 2150],[5460 8045 7809 17000]];
   
   //valeurs demission de carbone chez les sous traitants
  eup = [[0.2 0.17 0.15 0.3],[0.15 0.16 0.12 0.1],[0.27 0.36 0.12 0.2]];
  
  // volume d'occupation de la matiere premiere sur chaque mode de transport
  vr=[0.1 0.2 0.3];
  
  // volume d'occupation de la matiere premiere sur chaque mode de transport
  vp=[0.4 0.5 0.6];
  
  TCFS =  [[[[33.14164309 65.9250825 ],
   [65.46430948 59.03349837],
   [24.07847474 47.57900159],
   [15.91970824 59.40229498]],
  [[55.41408101 53.90429248],
   [50.7721737  53.68044713],
   [54.3787001  48.3288639 ],
   [17.62398342 52.97823236]],
  [[25.05447346 29.56189521],
   [21.96635949 50.98291114],
   [66.94474234 29.48189863],
   [40.01854937 44.91629509]]],
 [[[19.6620868  63.55835487],
   [35.70311723 44.1706014 ],
   [16.23149523 65.41941545],
   [52.00767703 67.57665938]],
  [[24.78494682 19.58880865],
   [28.77358356 32.40447243],
   [13.60140006 48.83345241],
   [61.9414683  35.16270404]],
  [[51.45963049 23.71627055],
   [57.04582901 54.0962704 ],
   [57.88696943 34.16823258],
   [13.19935809 55.73388425]]],
 [[[18.85744754 64.75811103],
   [54.64318176 28.50130141],
   [37.59918379 25.87621115],
   [43.31596646 14.71698669]],
  [[25.85291151 64.64326243],
   [33.37440506 36.48174378],
   [16.64929702 30.48725303],
   [37.05968943 55.71033978]],
  [[17.0770896  33.61266123],
   [40.36908749 33.49785643],
   [31.05278674 66.96059777],
   [61.85260854 47.29796301]]]];
   
  DTFS =  [[[ 33.51310149 243.08206455],
  [143.88492891 290.0368085 ],
  [203.95347078 133.31511866],
  [140.21294437 156.27592626]],
 [[ 62.20926179 255.66176508],
  [184.79414924 127.2612972 ],
  [269.23657796 145.45797777],
  [102.30229009 262.28118003]],
 [[250.08177833 235.89074873],
  [ 92.78239397 176.45937664],
  [247.02997918 103.74549218],
  [281.37716556 125.15754383]]];
  
  cf2 =  [[[[137.00408447 134.1161267  150.70945097],
   [153.03807952 201.81516694 148.25218779]],
  [[191.30898329 122.24337649 146.79055552],
   [149.77793962 200.33065645 216.02028609]],
  [[188.89811793 240.37261754 222.10642845],
   [215.33083069 201.37943646 194.25028863]]],
 [[[145.68235502 186.64478218 241.00473887],
   [178.76025287 218.56810561 183.38071272]],
  [[243.70179991 249.80251075 136.39293718],
   [178.0249885  147.03240542 229.95617194]],
  [[194.60255758 209.14055546 189.67782276],
   [126.10660306 192.16346934 137.16401748]]],
 [[[191.55419635 236.72574069 184.39593587],
   [131.08418625 147.9964148  220.28392225]],
  [[156.89812951 213.08183259 165.65891093],
   [194.64102932 228.36741463 141.17189305]],
  [[143.89953594 213.14268377 202.07938634],
   [151.32186617 147.81981259 227.63592317]]]];
   
  cf11 =  [[[[185.91134366 195.08459232],
   [175.62086424 235.92476474],
   [195.2863356  125.67462629],
   [207.57344658 225.09327317]],
  [[207.12583577 128.85949278],
   [205.71272673 164.83988298],
   [131.46859406 187.20037997],
   [198.72380937 221.09435735]],
  [[170.17416654 228.92515511],
   [179.12878034 149.32228447],
   [139.82077099 154.33958617],
   [200.73216245 204.44862143]]],
 [[[208.21178741 174.78067135],
   [189.76518433 122.07070672],
   [229.04389405 195.35572495],
   [245.21629012 248.47619225]],
  [[121.99559087 164.67181968],
   [147.46856717 154.18893052],
   [150.24631427 131.51010148],
   [177.39926877 165.90830056]],
  [[124.26496728 205.68997168],
   [184.94606724 201.26149619],
   [176.96303033 207.51850003],
   [189.21158328 147.78898537]]],
 [[[220.19662522 207.33562301],
   [219.77840465 213.74440681],
   [160.14034672 191.39564179],
   [174.06553141 162.64986741]],
  [[121.62651882 130.23274133],
   [223.73569293 140.30372756],
   [126.15659102 141.50459418],
   [177.38537463 143.7698712 ]],
  [[188.19386676 197.05871104],
   [193.04323453 212.44340313],
   [189.8287827  137.68285752],
   [178.94145854 148.2077627 ]]]];
   
   cf1 =  [[[[223.95832096 219.82018315],
   [163.28027427 198.48664169],
   [224.43491756 156.25213261]],
  [[247.95781743 235.89607539],
   [193.92041241 200.05110978],
   [247.14013554 122.14137865]],
  [[212.66547276 157.96358746],
   [204.312719   208.51216971],
   [136.14379464 238.3997887 ]]],
 [[[190.56107767 141.54045268],
   [130.52691956 248.83250586],
   [171.92480709 142.13256164]],
  [[153.25710157 196.12107686],
   [211.60665972 244.98092949],
   [181.17280068 227.14313736]],
  [[238.04932573 140.70644574],
   [216.70844575 132.2752297 ],
   [218.23081488 192.84567837]]],
 [[[246.519332   149.42358394],
   [125.04677899 214.05632474],
   [179.36865742 224.067023  ]],
  [[122.14438585 204.88555995],
   [202.14047919 215.00325419],
   [169.18298506 134.70523958]],
  [[238.7099931  215.42392633],
   [143.71779305 151.19654635],
   [172.07624597 129.48840821]]]];
  
  cf0 =  [[[[162.00140433 146.14077851 175.94618087],
   [235.4368267  151.73008775 144.48197358],
   [142.51749199 171.86440195 146.53473367],
   [129.97713307 208.66226286 141.92739009]],
  [[140.17637426 189.80853353 155.19065359],
   [195.78700723 222.83284479 158.4272133 ],
   [226.10445008 151.13225933 233.70294057],
   [204.6781821  208.13777367 139.21275261]],
  [[209.02841415 127.32568285 179.57157773],
   [193.80917646 156.48645359 210.7627633 ],
   [237.76644398 122.30491716 130.70513382],
   [214.70081466 167.00197859 161.3290704 ]]],
 [[[244.10317218 127.71712095 196.79287951],
   [207.2980631  192.02620378 127.78300796],
   [177.86158443 129.98198706 127.27009517],
   [186.58076848 130.11426283 171.68299855]],
  [[198.05574712 123.52992996 165.48721098],
   [235.02902735 127.79287951 181.95832223],
   [163.98936895 224.20502921 248.93481306],
   [150.52790914 149.51785237 236.53666035]],
  [[229.13290535 233.04439762 140.48703506],
   [241.92004486 160.81994577 131.50637897],
   [170.94115353 217.62551878 122.70330658],
   [127.45318783 165.00840281 218.6948233 ]]],
 [[[241.60967657 142.44909698 204.79627946],
   [128.99535175 210.53759803 134.87027329],
   [188.27592638 198.49721842 122.57111775],
   [163.63654299 168.4199892  180.08537516]],
  [[148.5826733  230.21167881 242.88728974],
   [241.43828392 199.40613408 158.859554  ],
   [203.756872   233.916524   132.35473158],
   [138.79203084 247.9032711  233.44573151]],
  [[214.01131596 161.97357282 183.80938078],
   [191.64418578 249.47318042 185.65214198],
   [212.9813124  205.56838218 171.85466688],
   [147.61325976 159.86358963 239.86852265]]]];
   
   
   cap = [10000 50000 100000];
   
   
    // ouverture du fichier excel pour la récupération des résultats
  SheetConnection my_sheet("results_p1.xlsx"); //connection au fichier excel pour les résultats
  
 // Lecture des information dans le fichier
  DM from SheetRead(my_sheet,"DM");
  cp from SheetRead(my_sheet,"cp");
  csu from SheetRead(my_sheet,"CSU");
   
 // ecriture dans le fichier de resultat
  AF to SheetWrite(my_sheet,"AF");
  AFS to SheetWrite(my_sheet,"AFS");
  ASU to SheetWrite(my_sheet,"ASU");
  Y to SheetWrite(my_sheet,"y");
  vcu to SheetWrite(my_sheet,"VCU");
  VCF to SheetWrite(my_sheet,"VCF");
  SW to SheetWrite(my_sheet,"SW");
  SU to SheetWrite(my_sheet,"SU");
 // N2 to SheetWrite(my_sheet,"st_client");
  SS to SheetWrite(my_sheet,"SSN");
  spl to SheetWrite(my_sheet,"SPL");
  SLC to SheetWrite(my_sheet,"SLC");
  SI to SheetWrite(my_sheet,"SI");
  SF to SheetWrite(my_sheet,"SF");
 // N10 to SheetWrite(my_sheet,"s_w");
  s to SheetWrite(my_sheet,"S");
  Y1 to SheetWrite(my_sheet,"prod_sous");
//  N01 to SheetWrite(my_sheet,"pl_wa");
//  N0 to SheetWrite(my_sheet,"N0");
  kp to SheetWrite(my_sheet,"KP");
  //DM to SheetWrite(my_sheet,"DM");
  //csu to SheetWrite(my_sheet,"CSU");
  CPW to SheetWrite(my_sheet,"CPW");
  cpfs to SheetWrite(my_sheet,"CPFS");
  CPF to SheetWrite(my_sheet,"CPF");
  PRS to SheetWrite(my_sheet,"PRS");
  pms to SheetWrite(my_sheet,"pms");
 // AS to SheetWrite(my_sheet,"ASSS");
 // AS to SheetWrite(my_sheet,"ASSS");
  
  // fin de copie des données de résultats
   